# 特权级

[toc]

## CPL DPL RPL

### CPL

当前的程序或任务的特权级
- 当程序转移到不同特权级的代码段时，会改变CPL
- 如果遇到了一致代码段，CPL不会被改变

### DPL

段或者门的特权级 Descriptor / Gate

当当前代码段试图访问一个段或者门时，DPL将会和CPL以及对应选择子的RPL相比较，根据下表的规则进行处理

| 段/门类型 | 规则 |
| -------- | ---- |
| 数据段 | DPL固定了可以访问此段的 **最低** 特权级|
| 非一致代码段 **不使用调用门** | DPL规定了 **访问该段的特权级** |
| 调用门 | DPL规定了 访问调用门的 **最低特权级** |
| 一致代码段 和 通过调用门访问的非一致代码段 | DPL规定了访问此段的 **最高特权级** |
| TSS | DPL 规定了 访问此TSS的 **最低特权级** |

### RPL
RPL存储在选择子中，处理器通过检查RPL和CPL来确认一个访问是否有足够的权限。RPL和CPL中特权较低的起决定性的作用

操作系统往往使用RPL来避免低特权级应用访问高特权级中的数据。

> 操作系统过程被调用，接收到一个选择子时，会将选择子的RPL设成调用者的特权级， **避免了操作系统用自己的权限去完成调用**